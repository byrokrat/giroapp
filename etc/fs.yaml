parameters:
    env(GIROAPP_PATH): 'giroapp'
    fs.user_dir: '%env(GIROAPP_PATH)%'
    fs.internal_data_dir: 'data'
    fs.external_data_dir: 'var'
    fs.plugins_dir: 'plugins'
    fs.imports_dir: '%fs.external_data_dir%/imports'

services:
    _defaults:
        public: false

    fs_user_dir_reader:
        class: byrokrat\giroapp\Utils\FileReader
        arguments: ['@fs_user_dir']

    fs_user_dir:
        class: League\Flysystem\Filesystem
        arguments: ['@fs_user_dir_adapter']
        configurator: 'byrokrat\giroapp\Setup\FilesystemConfigurator:createFiles'

    fs_user_dir_adapter:
        class: League\Flysystem\Adapter\Local
        arguments: ['%fs.user_dir%']

    byrokrat\giroapp\Setup\FilesystemConfigurator:
        class: ~
        arguments:
            -
                - '%db.settings%'
                - '%db.donors%'
                - '%db.transactions%'
                - '%db.log%'
                - '%db.imports%'
            -
                - '%fs.plugins_dir%'

    fs_imports:
        class: League\Flysystem\Filesystem
        arguments: ['@fs_imports_adapter']

    fs_imports_adapter:
        class: League\Flysystem\Adapter\Local
        arguments: ['%fs.user_dir%/%fs.imports_dir%']

    fs_cwd_reader:
        class: byrokrat\giroapp\Utils\FileReader
        arguments: ['@fs_cwd']

    fs_cwd:
        class: League\Flysystem\Filesystem
        arguments: ['@fs_cwd_adapter']

    fs_cwd_adapter:
        class: League\Flysystem\Adapter\Local
        arguments: ['.']
