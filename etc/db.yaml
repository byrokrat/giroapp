parameters:
    db.donors: 'donors.json'

services:
    _defaults:
        public: false
        autowire: true

    byrokrat\giroapp\Mapper\:
        resource: '../src/Mapper/*'

    flysystem_db:
        class: League\Flysystem\Filesystem
        arguments: ['@flysystem_db_adapter']

    flysystem_db_adapter:
        class: League\Flysystem\Adapter\Local
        arguments: ["@=service('fs_db').getAbsolutePath('.')"]

    db:
        class: hanneskod\yaysondb\Yaysondb
        arguments:
            -
                donors: '@db_donor_engine'

    byrokrat\giroapp\Mapper\DonorMapper:
        class: ~
        arguments: ['@db_donor_collection']

    db_donor_collection:
        class: hanneskod\yaysondb\Collection
        arguments: ['@db_donor_engine']

    db_donor_engine:
        class: hanneskod\yaysondb\Engine\FlysystemEngine
        arguments: ['%db.donors%', '@flysystem_db']
